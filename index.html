<!DOCTYPE html>  <html lang="es">  
<head>  
<meta charset="UTF-8" />  
<meta name="viewport" content="width=device-width, initial-scale=1" />  
<title>La Hermandad: El juego</title>  
<style>  
  body {  
    background-color: black;  
    color: white;  
    font-family: monospace;  
    display: flex;  
    flex-direction: column;  
    align-items: center;  
    justify-content: start;  
    height: 100vh;  
    margin: 0;  
    padding: 10px;  
  }  
  #mapa {  
    white-space: pre;  
    font-size: 24px;  
    line-height: 1.2;  
    user-select: none;  
    margin-bottom: 20px;  
  }  
  #dialogo {  
    background: #222;  
    border: 1px solid #555;  
    padding: 10px;  
    width: 90vw;  
    max-width: 600px;  
    min-height: 100px;  
    margin-bottom: 20px;  
    white-space: pre-line;  
  }  
  .botones-mov {  
    display: grid;  
    grid-template-columns: repeat(3, 50px);  
    grid-template-rows: repeat(3, 50px);  
    gap: 5px;  
    margin-bottom: 20px;  
  }  
  .botones-mov button {  
    font-size: 18px;  
    background: #111;  
    color: white;  
    border: 1px solid #444;  
    cursor: pointer;  
    user-select: none;  
  }  
  .botones-mov button:active {  
    background: #555;  
  }  
  #btn-reiniciar {  
    background: #222;  
    border: 1px solid #555;  
    color: white;  
    padding: 8px 20px;  
    font-size: 16px;  
    cursor: pointer;  
    margin-bottom: 15px;  
  }  
  #vidas {  
    font-size: 18px;  
    margin-bottom: 15px;  
  }  
</style>  
</head>  
<body>  <h1>La Hermandad: El juego</h1>  <div id="vidas"></div>  
<div id="mapa"></div>  
<div id="dialogo"></div>  <button id="btn-reiniciar">Reiniciar Juego</button>

<div class="botones-mov">  
  <button onclick="mover(-1, -1)" disabled></button>  
  <button onclick="mover(0, -1)">↑</button>  
  <button onclick="mover(1, -1)" disabled></button>  
  <button onclick="mover(-1, 0)">←</button>  
  <button disabled>o</button>  
  <button onclick="mover(1, 0)">→</button>  
  <button onclick="mover(-1, 1)" disabled></button>  
  <button onclick="mover(0, 1)">↓</button>  
  <button onclick="mover(1, 1)" disabled></button>  
</div>  <script>  
let mapas = [  
  [  
    "#####U#####",  
    "#         #",  
    "#         #",  
    "#    z    #",  
    "#         #",  
    "#         #",  
    "###########"  
  ],  
  [  
    "###########",  
    "#         #",  
    "#         #",  
    "#         #",  
    "#         #",  
    "#         #",  
    "#####U#####"  
  ]  
];  
    
  // === Variables y definición del enemigo Roibert ===  
  
let enCombate = false;  
let turnoJugador = true;  
let enemigoDerrotado = localStorage.getItem("roibertDerrotado") === "true";  
  
let enemigoRoibert = {  
    nombre: "Roibert",  
    vida: 75,  
    vidaMaxima: 75,  
    ataques: {  
        "Puños": () => Math.floor(Math.random() * 6) + 10, // 10–15  
        "Espalda": () => Math.floor(Math.random() * 15) + 1, // 1–15 defensa  
        "Roiner Casanova": () => Math.floor(Math.random() * 16) + 10 // 10–25  
    },  
    ataqueActual: "",  
    defensa: 0  
};  
  
let jugador = cargarJuego() || {  
  x: 4,  
  y: 5,  
  sala: 0,  
  simbolo: "o",  
  vida: 50,  
  vidaMax: 50,  
  zaidDialogIndex: 0,  
  armasEntregadas: false,  
  dialogoEntregaIndex: 0  
};  
  
const entregaArmasDialogs = [  
  "Zaid: Mno tienes que escapar de aquí, los cabros se volvieron loquisimos, toma esto bro.\n*Has recibido una espada, un escudo y a Luis Méndez*",  
  "La espada sirve para atacar a los cabros.\nAtaque: 5-10\nAtaque crítico: 20\nEl ataque será aleatorio, y el ataque crítico tiene una probabilidad menor de ocurrir.",  
  "El escudo te permite defenderte de los cabros.\nDefensa: 5-15\nLa defensa del escudo será aleatoria.",  
  "Luis Méndez.\nDaño: 0-50\nLuis Méndez reirá con un \"Je\".\nEl daño infligido dependerá de lo largo que sea el \"Je\"."  
];  
  
const zaidDialogs = [  
  "Mano ya te di todo",  
  "Que quieres mano",  
  "Mano dejame",  
  "Mamaguevo",  
  "No puedo creer que de verdad te cogieras a tu prima hermano, siempre te la pasas jugando con eso pero creí que eras mitomano"  
];  
  
const mapaDiv = document.getElementById("mapa");  
const dialogoDiv = document.getElementById("dialogo");  
const vidasDiv = document.getElementById("vidas");  
const btnReiniciar = document.getElementById("btn-reiniciar");  
  
function guardarJuego() {  
  localStorage.setItem("progresoHermandad", JSON.stringify(jugador));  
}  
  
function cargarJuego() {  
  const data = localStorage.getItem("progresoHermandad");  
  return data ? JSON.parse(data) : null;  
}  
  
function mostrarDialogo(texto) {  
  dialogoDiv.textContent = texto;  
}  
  
function renderizarMapa() {  
  let mapaActual = mapas[jugador.sala];  
  let salida = "";  
  for (let y = 0; y < mapaActual.length; y++) {  
    for (let x = 0; x < mapaActual[y].length; x++) {  
      salida += (x === jugador.x && y === jugador.y) ? jugador.simbolo : mapaActual[y][x];  
    }  
    salida += "\n";  
  }  
  mapaDiv.textContent = salida;  
  vidasDiv.textContent = `Vida: ${jugador.vida}/${jugador.vidaMax}`;  
}  
  
function hablarConZaid() {  
  if (!jugador.armasEntregadas) {  
    mostrarDialogo(entregaArmasDialogs[jugador.dialogoEntregaIndex]);  
    jugador.dialogoEntregaIndex++;  
    if (jugador.dialogoEntregaIndex >= entregaArmasDialogs.length) {  
      jugador.armasEntregadas = true;  
      jugador.dialogoEntregaIndex = 0;  
    }  
  } else {  
    mostrarDialogo("Zaid: " + zaidDialogs[jugador.zaidDialogIndex]);  
    jugador.zaidDialogIndex = (jugador.zaidDialogIndex + 1) % zaidDialogs.length;  
  }  
  guardarJuego();  
}  
  
function mover(dx, dy) {  
  const mapaActual = mapas[jugador.sala];  
  const nuevoX = jugador.x + dx;  
  const nuevoY = jugador.y + dy;  
  
  if (nuevoY < 0 || nuevoY >= mapaActual.length || nuevoX < 0 || nuevoX >= mapaActual[0].length) return;  
  
  const destino = mapaActual[nuevoY][nuevoX];  
  if (destino === "#") return;  
  
  if (destino === "z") {  
    hablarConZaid();  
    return;  
  }  
  
  if (destino === "R" && !enemigoDerrotado) {  
    jugador.x = nuevoX;  
    jugador.y = nuevoY;  
    renderizarMapa();  
    iniciarCombate(); // Aquí se lanza el combate con Roibert  
    return;  
  }  
  
  if (destino === "D") {  
    if (jugador.sala === 0) {  
      jugador.sala = 1;  
      jugador.x = 5;  
      jugador.y = 6;  
    } else {  
      jugador.sala = 0;  
      jugador.x = 5;  
      jugador.y = 1;  
    }  
    renderizarMapa();  
    mostrarDialogo("Has cambiado de sala.");  
    guardarJuego();  
    return;  
  }  
  
  jugador.x = nuevoX;  
  jugador.y = nuevoY;  
  mostrarDialogo("");  
  renderizarMapa();  
  guardarJuego();  
      }  
  
  function iniciarCombate() {  
  mostrarDialogo("¡Te enfrentas a Roibert!");  
  
  // Añadir botones de combate  
  dialogoDiv.innerHTML = `  
    ¡Te enfrentas a Roibert!<br>  
    Vida de Roibert: ${enemigoRoibert.vida}<br><br>  
    <button onclick="usarEspada()">Espada</button>  
    <button onclick="usarEscudo()">Escudo</button>  
    <button onclick="usarLuisMendez()">Luis Méndez</button>  
  `;  
}  
  
function usarEspada() {  
  let critico = Math.random() < 0.2; // 20% de probabilidad  
  let daño = critico ? 10 : Math.floor(Math.random() * 5) + 1;  
  
  enemigoRoibert.vida -= daño;  
  mostrarDialogo(`Usaste espada. ${critico ? "¡Crítico! " : ""}Daño: ${daño}\nVida de Roibert: ${enemigoRoibert.vida}`);  
  revisarResultado();  
  turnoEnemigo();  
}  
  
function usarEscudo() {  
  jugador.defensa = Math.floor(Math.random() * 10) + 1;  
  mostrarDialogo(`Usaste escudo. Defensa establecida: ${jugador.defensa}`);  
  turnoEnemigo();  
}  
  
function usarLuisMendez() {  
  const jeLargo = "Je".repeat(Math.floor(Math.random() * 6) + 1); // Entre 1 y 6  
  const daño = Math.floor(Math.random() * 51); // 0 a 50  
  enemigoRoibert.vida -= daño;  
  mostrarDialogo(`Luis Méndez: ${jeLargo}\nDaño infligido: ${daño}\nVida de Roibert: ${enemigoRoibert.vida}`);  
  revisarResultado();  
  turnoEnemigo();  
}  
  
function turnoEnemigo() {  
  if (enemigoRoibert.vida <= 0) return;  
  
  const ataques = Object.keys(enemigoRoibert.ataques);  
  const ataque = ataques[Math.floor(Math.random() * ataques.length)];  
  const efecto = enemigoRoibert.ataques[ataque]();  
  
  if (ataque === "Espalda") {  
    enemigoRoibert.defensa = efecto;  
    mostrarDialogo(`Roibert se protegió con la espalda. Defensa: ${efecto}`);  
  } else {  
    const dañoRecibido = Math.max(0, efecto - (jugador.defensa || 0));  
    jugador.vida -= dañoRecibido;  
    mostrarDialogo(`Roibert usó ${ataque}. Te hizo ${dañoRecibido} de daño.\nVida: ${jugador.vida}/${jugador.vidaMax}`);  
  }  
  
  jugador.defensa = 0; // Reset defensa  
  revisarResultado();  
}  
  
function revisarResultado() {  
  if (jugador.vida <= 0) {  
    mostrarDialogo("*Foto de Roibert semi-desnudo");  
    desactivarCombate();  
  } else if (enemigoRoibert.vida <= 0) {  
    mostrarDialogo("Luis: God mano");  
    desactivarCombate();  
  }  
}  
  
function desactivarCombate() {
  dialogoDiv.innerHTML += `<br><button onclick="terminarCombate()">Continuar</button>`;
}

function terminarCombate() {
  enCombate = false;
  renderizarMapa();
  mostrarDialogo("");
  }
  
btnReiniciar.onclick = () => {  
  jugador = {  
    x: 4,  
    y: 5,  
    sala: 0,  
    simbolo: "o",  
    vida: 50,  
    vidaMax: 50,  
    zaidDialogIndex: 0,  
    armasEntregadas: false,  
    dialogoEntregaIndex: 0  
  };  
  mostrarDialogo("");  
  renderizarMapa();  
  guardarJuego();  
};  
  
renderizarMapa();  
</script>  </body>  
</html>

  
